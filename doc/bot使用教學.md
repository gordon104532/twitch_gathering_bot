# 87集氣活動bot功能&設定教學 
by 歐法多來夫

[使用說明Doc-傳送門](https://reurl.cc/KQ0b3j)

點一下左邊的大綱能更一目了然喔!

＜8/27追記＞：增加了有關對綠界的教學

## 活動bot功能介紹
a.分數計算

> 自動偵測訂閱/贈訂、小奇點、歐付寶/綠界贊助

> 自訂訂閱、小奇點、歐付寶/綠界贊助之exp分數

> 手動調整exp功能

> 十個自訂等級門檻

> 支援OBS與StreamlabOBS的集氣條插件 (可更改顏色)

b.聊天室指令與自動訊息

> 手動調整exp指令

> exp查詢指令

> 聊天室歐付寶贊助通知

> 集氣等級升級訊息


##  bot設定教學
### a.前置動作

1. 於活動DC群「bot下載與教學」頻道內下載「87bot」，解壓縮至任一資料夾

2. 啟動一次「87bot.exe」(這時可能會跳出防火牆警告，直接按取消即可)，讓程式自動生成ExpSetting.txt、gatTotalPoint.txt及index.tmpl，之後關掉


### b.帳號連結設定

1. 首先取得自己的 "Twitch OAth" 及 "opayID"(歐付寶) 或"ecpayID"(綠界)

	1-1. 至 https://twitchapps.com/tmi/  取得"Twitch OAth”
	此權限是讓bot代替你在聊天室發話，請務必妥善保管
	未來不使用時，可於Twitch "帳號設定>連結" 頁面中取消連結


	1-2. 至歐付寶/綠界贊助頁面，找到網址最後面的贊助ID，如下圖
	(若不計算歐付寶或綠界請看下方備註) 

2. 打開botSetting.txt，於下列位置分別填上 "Twitch英文ID"、"Twitch OAth"、 "opayID"及"ecpayID"


※註：若不計算歐付寶或綠界的exp，請在填寫opayID或ecpayID前一行的：

　　　　　　　"checkDonate": true,

　　　將 true 改為 false 即可

### c.集氣分數設定

1. 在botSetting.txt中，於下圖中的參數位置分別設定訂閱、小奇點、贊助之exp分數，與各等級的exp門檻:
(此為exp設定範例，按自己的需求更改即可)

2. 打開ExpSetting.txt，可詳細設定贈訂 / 續訂 / 新訂閱 / 層1~3 以及不同訂閱週期之exp的"倍數"  (基於botSetting.txt內設定的層1訂閱exp)，說明如下圖:

### d.集氣條插件設定

1. 在OBS或StreamlabOBS新增一個瀏覽器來源，並輸入：

		網址: http://127.0.0.1:8787/87
		寬度: 500
		高度: 100

若集氣條無成功顯示，嘗試將網址改掉再改回即可

2. 在ExpSetting.txt中，可於下圖中的參數位置輸入色碼以設定標題字、集氣條及集氣條內計數文字的顏色，注意每次改完顏色都必須重開bot才會更新

(圖為範例，集氣條擷取成功、顏色也有改到就會像下圖)



## 聊天室指令

### a. 手動調整exp指令
在聊天室加減數字，例： " +87 "、 " -87 "，此指令為台主限定，注意每筆加減須分次key in不然會誤判

### b. exp查詢指令
在聊天室輸入：" !87LV " 或 " !87lv "，所有人都可以使用，有30秒CD時間


## 正式使用前的檢測

### a.前置動作
1. 複製一份設定好的botSetting.txt作為備份，因為bot啟動之後裡面的格式會跑掉orz

2. 開啟bot，進行後續的測試步驟

### b. 啟動檢測
啟動bot後出現 "歐付寶/綠界Donate檢查已成功 1 次"，且無 "[ERROR]" 即pass
(有[WARNING]沒關係)

### c. 計分與指令檢測

1. 歐付寶/綠界測試：使用歐付寶/綠界的贊助測試功能，聊天室有出現訊息即pass

2. 訂閱/小奇點測試......如果有人願意丟訂閱跟小奇點幫忙測就好了qq

3. 在聊天室使用指令手動調整exp，並加分超過一個等級，檢查升級訊息是否正常出現

4. 在聊天室使用exp查詢指令，檢查目前的計分與等級是否正確


(以上步驟後，聊天室就會出現這些訊息)



5. 檢查目前所有的加減分事件是否都有被記錄至資料夾內的"gatTotalPoint.txt"中


※若有任何問題請在活動DC群「bot客服專線」頻道發問


### d. 測試完成恢復設置

關閉bot後，把備份好的botSetting.txt蓋回去，並將"gatTotalPoint.txt"刪除

"gatTotalPoint.txt"在下次開啟bot時會再次生成，之後不必再刪除

調閱分數紀錄

活動開始後，累計的exp分數會紀錄在botSetting.txt最尾端的"initPoint"


(這是你的心肝寶貝，不要弄丟他)

"gatTotalPoint.txt"也記錄了所有加減分事件
若需要舉行有條件的贊助者抽獎，可提取當中的資料作為抽獎資格依據

## 其他注意事項

1. 活動期間，實況前記得要打開87bot！

2. 請勿在開啟bot的狀況下執行歐付寶測試，避免分數誤加

3. 現金贊助僅偵測歐付寶/綠界，paypal等其他方式請以手動加分處理

4. 手動調整分數時一定要分次key in不然會誤判，例: +87+87 會被視為 +8787

5. 任何數值設定都不可以有小數點，否則bot會自動忽略甚至產生錯誤

6. 所有等級門檻設定都必須低於999999999

<最後修訂日期: 2022/08/28>